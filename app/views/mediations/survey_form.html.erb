<%# Use the same intake-page styling for consistent look %>
<% content_for :body_class, 'intake-page' %>

<div class="signup-container">
  <div class="signup-card intake-card" style="max-width: 900px;">
    <h1>End of Mediation Survey</h1>
    <h2>Please provide feedback about your experience. This will help us improve the platform.</h2>

    <%= form_with model: @survey, url: mediation_survey_path(@mediation.ConversationID), method: :post, local: true do |f| %>
      
      <!-- Question 1: Tool Ease -->
      <div class="form-section">
        <%= f.label :tool_ease, "How easy was the tool to use?", class: "required-label" %>
        <label style="display: block; margin-top: 10px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :tool_ease, "very_easy", required: true, id: "ease_very_easy", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Very easy</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :tool_ease, "easy", id: "ease_easy", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Easy</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :tool_ease, "neutral", id: "ease_neutral", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Neutral</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :tool_ease, "hard", id: "ease_hard", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Hard</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :tool_ease, "very_hard", id: "ease_very_hard", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Very hard</span>
        </label>
      </div>

      <!-- Question 3: Info Clear -->
      <div class="form-section">
        <%= f.label :info_clear, "Was the information clear and easy to understand?", class: "required-label" %>
        <label style="display: block; margin-top: 10px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :info_clear, "yes", required: true, id: "info_yes", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Yes</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :info_clear, "somewhat", id: "info_somewhat", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Somewhat</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :info_clear, "no", id: "info_no", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">No</span>
        </label>
      </div>

      <!-- Question 4: Understood Mediation -->
      <div class="form-section">
        <%= f.label :understood_mediation, "Did you understand what mediation is after using this tool?", class: "required-label" %>
        <label style="display: block; margin-top: 10px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :understood_mediation, "yes", required: true, id: "understood_yes", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Yes</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :understood_mediation, "somewhat", id: "understood_somewhat", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Somewhat</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :understood_mediation, "no", id: "understood_no", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">No</span>
        </label>
      </div>

      <!-- Question 5: Other Participated -->
      <div class="form-section">
        <%= f.label :other_participated, "Did the other party participate in the conversation?", class: "required-label" %>
        <label style="display: block; margin-top: 10px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :other_participated, "yes", required: true, id: "participated_yes", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Yes</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :other_participated, "no", id: "participated_no", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">No</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :other_participated, "not_sure", id: "participated_not_sure", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Not sure</span>
        </label>
      </div>

      <!-- Question 6: Good Faith (with definition) -->
      <div class="form-section">
        <%= f.label :good_faith, "Did you feel the other party acted in good faith?", class: "required-label" %>
        <p style="margin: 8px 0; font-size: 14px; color: #555;">
          ("Good faith" means they responded, communicated honestly, and made a real attempt to resolve the issue.)
        </p>
        <label style="display: block; margin-top: 10px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :good_faith, "yes", required: true, id: "good_faith_yes", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Yes</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :good_faith, "somewhat", id: "good_faith_somewhat", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Somewhat</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :good_faith, "no", id: "good_faith_no", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">No</span>
        </label>
      </div>

      <!-- Question 7: Helped Communicate -->
      <div class="form-section">
        <%= f.label :helped_communicate, "Did the platform help you communicate your side of the issue?", class: "required-label" %>
        <label style="display: block; margin-top: 10px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :helped_communicate, "yes", required: true, id: "communicate_yes", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Yes</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :helped_communicate, "somewhat", id: "communicate_somewhat", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Somewhat</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :helped_communicate, "no", id: "communicate_no", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">No</span>
        </label>
      </div>

      <!-- Question 8: Would Recommend -->
      <div class="form-section">
        <%= f.label :would_recommend, "Would you recommend this tool to someone in your situation?", class: "required-label" %>
        <label style="display: block; margin-top: 10px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :would_recommend, "yes", required: true, id: "recommend_yes", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Yes</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :would_recommend, "maybe", id: "recommend_maybe", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Maybe</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :would_recommend, "no", id: "recommend_no", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">No</span>
        </label>
      </div>

      <!-- Question 9: Liked Most (text area) -->
      <div class="form-section">
        <%= f.label :liked_most, "What did you like most about the platform? (Optional)" %>
        <%= f.text_area :liked_most, rows: 4, style: "width: 100%; padding: 10px; margin-top: 10px;" %>
      </div>

      <!-- Question 10: Should Improve (text area) -->
      <div class="form-section">
        <%= f.label :should_improve, "What should we improve? (Optional)" %>
        <%= f.text_area :should_improve, rows: 4, style: "width: 100%; padding: 10px; margin-top: 10px;" %>
      </div>

      <!-- Question 11: Device Used -->
      <div class="form-section">
        <%= f.label :device_used, "What device did you use today?", class: "required-label" %>
        <label style="display: block; margin-top: 10px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :device_used, "phone", required: true, id: "device_phone", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Phone</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :device_used, "tablet", id: "device_tablet", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Tablet</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :device_used, "computer", id: "device_computer", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Computer</span>
        </label>
        <label style="display: block; margin-top: 8px; cursor: pointer; font-weight: normal;">
          <%= f.radio_button :device_used, "not_sure", id: "device_not_sure", style: "margin-right: 8px; vertical-align: middle;" %>
          <span style="vertical-align: middle;">Not sure</span>
        </label>
      </div>

      <div class="form-footer">
        <%= f.submit "Submit Survey", class: 'signup-btn' %>
      </div>
    <% end %>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector("form[action*='survey']");
    
    if (form) {
      form.addEventListener("submit", function (event) {
        // Check all required fields
        const toolEase = document.querySelector('input[name="survey_response[tool_ease]"]:checked');
        const infoClear = document.querySelector('input[name="survey_response[info_clear]"]:checked');
        const understoodMediation = document.querySelector('input[name="survey_response[understood_mediation]"]:checked');
        const otherParticipated = document.querySelector('input[name="survey_response[other_participated]"]:checked');
        const goodFaith = document.querySelector('input[name="survey_response[good_faith]"]:checked');
        const helpedCommunicate = document.querySelector('input[name="survey_response[helped_communicate]"]:checked');
        const wouldRecommend = document.querySelector('input[name="survey_response[would_recommend]"]:checked');
        const deviceUsed = document.querySelector('input[name="survey_response[device_used]"]:checked');

        if (!toolEase || !infoClear || !understoodMediation || !otherParticipated || 
            !goodFaith || !helpedCommunicate || !wouldRecommend || !deviceUsed) {
          alert("Please answer all required questions before submitting.");
          event.preventDefault();
        }
      });
    }
  });
</script>
